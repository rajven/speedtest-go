#Map CORS allowed origin based on the incoming Origin header
#Allows requests only from speedtest.example.com and myip.example.com (both HTTP and HTTPS)
#Sets $cors_origin to the value of $http_origin if matched, otherwise sets it to empty string

map $http_origin $cors_origin {
    default "";
    "~^https?://(speedtest\.example\.com|myip\.example\.com)$" $http_origin;
}
